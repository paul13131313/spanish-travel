# ¡Hablemos! v2 - ペルー・ボリビア旅行スペイン語トレーナー

## コンセプト
スマホで1問ずつランダム表示。聴いて、口に出して、覚える。それだけ。

## 技術スタック
- シングルHTML（GitHub Pages デプロイ）
- HTML / CSS / JavaScript のみ
- Web Speech API（SpeechSynthesisのみ。音声認識は使わない）
- localStorage で学習進捗を保存
- スマホ専用設計（PCでも崩れないが、スマホ片手操作が最優先）

## 画面構成（全1画面）

スクロールなし。1画面に1フレーズ。すべてが1つのビューに収まる。

```
┌─────────────────────────┐
│  ¡Hablemos!    [⚙]      │  ← ヘッダー（最小限）
│                          │
│   カテゴリアイコン＋名前   │
│                          │
│ ┌──────────────────────┐ │
│ │                      │ │
│ │  スペイン語フレーズ    │ │  ← メインカード
│ │    （大きく表示）      │ │
│ │                      │ │
│ │  🔊 ノーマル  🐢 ゆっくり│ │  ← 読み上げボタン（カード内）
│ │                      │ │
│ └──────────────────────┘ │
│                          │
│  ▼ タップで日本語を見る   │  ← 日本語は隠しておく
│                          │
│  ┌────────────────────┐  │
│  │ 日本語訳            │  │  ← 展開時に表示
│  │ 発音: カタカナ       │  │
│  │ 💡 ポイント解説      │  │
│  └────────────────────┘  │
│                          │
│  [🔀 つぎ]              │  ← 画面下部に固定
│  ━━━━━━━━━━━━━━━━━━━━  │  ← 進捗バー（何問やったか）
│  📊 今日 12問 / 覚えた 34│  ← ミニステータス
└─────────────────────────┘
```

## 操作フロー

1. アプリを開く → ランダムで1フレーズ表示（スペイン語のみ）
2. 🔊ボタンで音声を聴く（ノーマル / ゆっくりの2段階）
3. 口に出して練習
4. 「タップで日本語を見る」で意味・発音ガイド・解説を確認
5. 「つぎ」ボタンで次のランダムフレーズへ（アニメーションで切り替え）
6. 長押しまたはスワイプ上で「覚えた」マーク → 出題頻度が下がる

## UIの詳細仕様

### メインカード
- スペイン語テキストは画面の中央に大きく表示（フォントサイズは文字数に応じて自動調整）
- 長いフレーズでも1画面に収める（最小20px、最大36px程度で可変）
- カードの切り替えはフェード or スライドアニメーション（300ms程度、軽く）

### 読み上げボタン
- 🔊 ノーマル速度（rate: 1.0）
- 🐢 ゆっくり（rate: 0.65）
- 言語: `es-419`を優先、なければ`es-ES`
- ボタンは十分大きく（最低48px四方）、カード内に配置
- 再生中はボタンにアニメーション（パルスなど）で再生中とわかるように

### 日本語エリア（トグル表示）
- デフォルトは非表示（スペイン語だけ見て考える時間を作る）
- タップで展開。表示内容：
  - 日本語訳
  - カタカナ発音ガイド
  - 💡 発音のコツ or 使い方の解説（1-2行）
  - 地域タグ（🇵🇪ペルー / 🇧🇴ボリビア / 共通）

### 「つぎ」ボタン
- 画面最下部に固定（position: fixed）
- 大きく、押しやすく（幅100%、高さ56px程度）
- ランダムで次のフレーズを表示
- 出題ロジック: 「覚えた」マークしていないフレーズを優先、覚えたものも低確率（20%）で出す

### 「覚えた」操作
- カードを上にスワイプ or 長押し → 「覚えた！✅」フィードバック表示
- 覚えたフレーズは出題頻度が下がるだけで、完全には消えない
- 覚えたマークは取り消し可能

### 設定（⚙アイコン）
- フィルタ: カテゴリ選択（複数選択可。デフォルトは全カテゴリ）
- フィルタ: 地域（全部 / ペルーのみ / ボリビアのみ）
- 覚えたフレーズを含める / 含めない
- 読み上げ速度のデフォルト設定
- 学習リセット

### 進捗表示（画面下部）
- 今日の学習数（「つぎ」を押した回数）
- 覚えたフレーズ総数 / 全フレーズ数
- 薄いプログレスバーで視覚化

## カテゴリ構成（各15〜20フレーズ、合計120以上）

| emoji | カテゴリ | 内容 |
|-------|---------|------|
| 🛬 | 空港・移動 | タクシー交渉、バス乗り場、〜はどこ？ |
| 🏨 | 宿泊 | チェックイン/アウト、Wi-Fi、部屋トラブル |
| 🍽️ | 食事 | 注文、おすすめ聞く、会計、アレルギー |
| 🛒 | 買い物・市場 | 値段交渉、「もう少し安く」、サイズ |
| 🗣️ | 日常会話 | 挨拶、自己紹介、天気、感謝 |
| 🆘 | 緊急・トラブル | 道に迷った、盗難、病院、助けて |
| 📸 | 観光 | 写真撮って、入場料、おすすめスポット |
| 🤝 | 仲良くなる | 褒める、乾杯、SNS交換、「また会おう」 |
| 🇵🇪🇧🇴 | 現地スラング | chevere, pata, jailón, yapa 等 |

## フレーズデータ構造

```javascript
{
  id: "food_01",
  category: "food",
  emoji: "🍽️",
  es: "¿Me puede recomendar algo típico de aquí?",
  ja: "ここの名物料理をおすすめしてもらえますか？",
  pronunciation: "メ・プエデ・レコメンダール・アルゴ・ティピコ・デ・アキ？",
  tip: "「típico」で地元料理を聞ける万能フレーズ。市場でもレストランでも使える",
  difficulty: 2,
  region: "common"  // "common" | "peru" | "bolivia"
}
```

## デザイン方針

### コンセプト: 南米の空と土
明るく温かい配色。旅のワクワク感。

- **背景**: 温かみのあるベージュ〜サンド系。微かなテクスチャ
- **メインカード**: 白背景、角丸大きめ、柔らかいシャドウ
- **アクセント色**: テラコッタ（#C2714F）、インディゴ（#2D5F8A）
- **フォント**: 
  - スペイン語フレーズ: 個性的で読みやすいセリフ or ディスプレイ系（Google Fonts）
  - 日本語: system-ui で軽く
  - カテゴリラベル等: 手書き風（Caveat等）
- **ボタン**: 角丸大きめ、タップ時に心地よいフィードバック（scale + haptic的な色変化）
- **カード切り替え**: 軽いフェードまたは横スライド（重い3Dエフェクトは不要）

### スマホ最適化（最重要）
- **viewport固定**: 100vh を使い、スクロール一切なし
- **タップターゲット**: 全ボタン最低48px
- **片手操作**: 主要操作は画面下半分に集中
- **セーフエリア**: ノッチ・ホームバーを考慮（env(safe-area-inset-bottom)）
- **フォントサイズ**: スペイン語は最低20px、日本語は最低16px
- **横向き非対応でOK**（縦固定想定）

## localStorage

```javascript
{
  learned: ["food_01", "travel_03"],          // 覚えたフレーズID
  todayCount: 12,                              // 今日の学習数
  todayDate: "2026-02-19",                     // 日付変わったらリセット
  settings: {
    categories: ["all"],                       // フィルタ
    region: "all",
    includeLearnedInDrill: true,
    defaultSpeed: "normal"
  }
}
```

## 実装の優先順位

1. フレーズデータ全量（9カテゴリ × 15-20 = 120フレーズ以上）
2. 1画面1フレーズのカードUI（スクロールなし、100vh固定）
3. ランダム出題ロジック（覚えたフレーズの出題頻度調整含む）
4. 読み上げ機能（ノーマル＋ゆっくり、es-419優先）
5. 日本語トグル表示
6. 覚えたマーク（スワイプ上 or 長押し）
7. 設定画面（カテゴリフィルタ、地域フィルタ）
8. 進捗表示
9. デザイン仕上げ

## 検証方法
- [ ] スマホ（iPhone Safari / Android Chrome）で100vh内に収まり、スクロールしない
- [ ] 読み上げボタンが動作する（es-419 or es-ES）
- [ ] 「つぎ」を押すたびに別のフレーズがランダム表示される
- [ ] 日本語エリアがタップで開閉する
- [ ] 覚えたマークが保存され、リロード後も維持される
- [ ] 120フレーズ以上が実装されている
- [ ] 全ボタンがスマホで押しやすいサイズ（48px以上）

## 補足
- 音声認識（SpeechRecognition）は使わない。読み上げ（SpeechSynthesis）のみ
- シングルHTMLなのでフレーズデータはJS内にハードコード
- フレーズは中南米スペイン語（ペルー・ボリビアで通じる表現）
- カタカナ発音は完璧でなくていいが、日本人が読んで近い音が出るよう工夫
- 100vhの罠に注意: スマホではアドレスバー分を考慮して `100dvh` or `window.innerHeight` を使う
