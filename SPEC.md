# ¡Hablemos! - ペルー・ボリビア旅行スペイン語トレーナー

## 概要
ペルー・ボリビアへの1ヶ月旅行に向けて、旅先で実際に使うスペイン語会話を「聴いて・声に出して・覚える」学習サイト。Web Speech APIを活用し、ネイティブ発音の再生と自分の発音チェックをブラウザだけで完結させる。

## 技術スタック
- **シングルHTML**（GitHub Pages デプロイ想定）
- HTML / CSS / JavaScript のみ（フレームワーク不要）
- Web Speech API（SpeechSynthesis + SpeechRecognition）
- localStorage でデータ永続化
- レスポンシブ（スマホメインで使う前提）

## 画面構成

### 1. ホーム画面
- 今日の進捗サマリー（学習フレーズ数 / 発音スコア）
- カテゴリ一覧（カード形式）
- 「今日のひとこと」ランダム慣用句表示

### 2. カテゴリ別フレーズ学習画面
各カテゴリのフレーズ一覧。タップで詳細カードを開く。

### 3. フレーズ詳細カード（学習のメイン画面）
以下を1画面に収める：
- スペイン語テキスト（大きく表示）
- 日本語訳
- 発音ガイド（カタカナ表記 + 発音ポイント解説）
- 🔊 **聴くボタン**：Web Speech API で読み上げ（言語: es-ES、rate: 0.8 のゆっくりモード付き）
- 🎤 **話すボタン**：音声認識で自分の発音をチェック → 認識結果とフレーズを比較してスコア表示
- ✅ **覚えたボタン**：学習済みマーク

### 4. 慣用句・スラング辞典画面
ペルー・ボリビア特有の表現を解説付きで一覧表示。検索・フィルタ機能付き。

### 5. 発音ドリル画面
ランダム出題モード。フレーズが表示→音声認識で回答→スコアフィードバック。連続正解でストリーク表示。

## カテゴリ構成（各15〜20フレーズ）

| カテゴリ | 内容例 |
|---------|--------|
| 🛬 空港・移動 | チェックイン、タクシー交渉、バス乗り場を聞く |
| 🏨 宿泊 | チェックイン/アウト、Wi-Fi聞く、部屋の問題 |
| 🍽️ 食事 | 注文、おすすめを聞く、会計、食材アレルギー |
| 🛒 買い物・市場 | 値段交渉、サイズ、「もう少し安くして」 |
| 🗣️ 日常会話 | 挨拶、自己紹介、「日本から来ました」 |
| 🆘 緊急・トラブル | 道に迷った、病院、警察、盗難 |
| 📸 観光 | 写真撮って、おすすめスポット、歴史を聞く |
| 🤝 仲良くなる | 褒める、感謝、冗談、SNS交換 |
| 🇵🇪🇧🇴 現地スラング・慣用句 | ペルー/ボリビア特有の表現（chevere, pata, jailón等） |

## フレーズデータ構造

```javascript
{
  id: "food_01",
  category: "food",
  es: "¿Me puede recomendar algo típico de aquí?",
  ja: "この地域の名物料理をおすすめしてもらえますか？",
  pronunciation: "メ・プエデ・レコメンダール・アルゴ・ティピコ・デ・アキ？",
  tip: "「típico」の「ti」は英語の「tea」のように。地元の食べ物を聞くときの鉄板フレーズ",
  difficulty: 2,        // 1-3
  region: "common",     // "common" | "peru" | "bolivia"
  situation: "レストランで店員に話しかける場面",
  learned: false
}
```

## 発音機能の仕様

### 読み上げ（SpeechSynthesis）
- デフォルト速度と0.7倍速の切り替えボタン
- 言語設定: `es-ES`（es-419が利用可能ならそちらを優先＝中南米発音）
- フレーズ内の強調すべき単語をハイライト同期（utterance.onboundary）

### 音声認識（SpeechRecognition）
- 言語設定: `es-ES`（同上）
- 認識結果とフレーズの文字列一致率をスコア化（0-100%）
- 80%以上で「¡Muy bien!」、50-79%で「¡Casi!」、50%未満で「Otra vez（もう一回）」
- 結果テキストを表示して、どこが違ったか視覚的にdiff表示（一致=緑、不一致=赤）

### 注意
- SpeechRecognition 非対応ブラウザ（Firefox等）では「話す」ボタンを非表示にし、聴く＋カタカナ発音ガイドのみで学習可能にする
- 対応チェック: `'webkitSpeechRecognition' in window || 'SpeechRecognition' in window`

## デザイン方針

### コンセプト: 「旅ノート」
手書き風の温かみのあるデザイン。まるで旅先でつけるノートのような雰囲気。

- **フォント**: タイトルに手書き風Googleフォント（Caveat, Patrick Hand等）、本文は読みやすいサンセリフ
- **配色**: サンドベージュ背景 + テラコッタ（ペルーの土壁イメージ）+ インディゴブルー（ティティカカ湖）のアクセント
- **装飾**: 紙テクスチャ背景、マスキングテープ風のカテゴリラベル、手描き風アイコン
- **カード**: 少し傾いた付箋風、影付き
- **アニメーション**: ページめくり風のトランジション、スコア表示時のお祝いエフェクト

### モバイルファースト
- タップターゲット最低44px
- フレーズカードはスワイプで次へ（touch対応）
- 片手操作を意識したボタン配置（下部固定）

## localStorage 保存データ
```javascript
{
  learnedPhrases: ["food_01", "travel_03", ...],
  drillHistory: [{ date: "2025-02-19", score: 85, count: 10 }],
  settings: { speechRate: 1.0, preferSlowMode: false }
}
```

## 実装の優先順位
1. フレーズデータ（全カテゴリ分、最低120フレーズ）
2. フレーズ詳細カードUI + 読み上げ機能
3. 音声認識 + スコアリング + diff表示
4. カテゴリ一覧 + ホーム画面
5. 発音ドリルモード
6. 慣用句辞典
7. 進捗トラッキング + localStorage
8. デザイン仕上げ・アニメーション

## 検証方法
- [ ] Chrome（Android / PC）で読み上げが再生される
- [ ] 音声認識が起動し、結果テキストが表示される
- [ ] es-419 の音声が利用可能な場合はそちらが選択されている
- [ ] Firefox で音声認識ボタンが非表示になり、他の機能は動作する
- [ ] スマホで片手操作できるレイアウトになっている
- [ ] 120フレーズ以上が実装されている
- [ ] localStorage に学習進捗が保存・復元される

## 補足
- シングルHTMLなのでフレーズデータはJS内にハードコード
- フレーズの正確性が重要。ペルー・ボリビアで実際に通じる表現を使うこと
- カタカナ発音ガイドは完璧でなくていいが、日本人が読んで近い音が出るよう工夫する
- 「ペルーではこう言う」「ボリビアではこう言う」の地域差がある場合は注記する
